<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Battle Royale of Shame — Cinematic</title>
<style>
:root{
  --bg:#0b0b0c; --panel:#161618; --ink:#e9e9ea;
  --gore:#a30312; --gore2:#5b020a; --accent:#ffcc00;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0; color:var(--ink); background:var(--bg); font-family:Inter,Segoe UI,Roboto,system-ui,Arial,sans-serif; overflow:hidden;}
.topbar{padding:14px 12px 6px; text-align:center}
h1{margin:0; color:var(--gore); text-shadow:0 0 24px #000, 0 0 6px var(--gore2)}
.sub{opacity:.8; font-size:.92rem}

.wrap{
  height:calc(100% - 78px);
  display:grid; gap:12px; grid-template-columns: 1.4fr .9fr; padding:12px; max-width:1400px; margin:0 auto;
}
@media (max-width: 980px){ .wrap{grid-template-columns:1fr; grid-auto-rows:minmax(0,1fr)} }

.panel{background:var(--panel); border:1px solid #232327; border-radius:14px; position:relative; overflow:hidden;
  box-shadow: inset 0 0 30px #000;
}
.sidePanel{display:flex; flex-direction:column; padding:12px}
.sidePanel h2{margin:8px 6px 10px; font-size:1.05rem; opacity:.92}

.arenaPanel{padding:0}
.bgCycler{
  position:absolute; inset:0; z-index:0; pointer-events:none; transition:opacity .8s ease;
  background:#0d0d10;
}
.bgCycler.apoc1{background:
  radial-gradient(80% 100% at 30% 0%, #1a1a1e 0 60%, transparent 70%),
  linear-gradient(#110f10,#0a0a0b);}
.bgCycler.apoc2{background:
  radial-gradient(60% 80% at 70% 20%, rgba(255,140,0,.10), transparent),
  linear-gradient(#22160e,#0b090a);}
.bgCycler.apoc3{background:
  radial-gradient(70% 90% at 30% 20%, rgba(163,3,18,.14), transparent),
  linear-gradient(#131314,#0a0a0b);}
.bgCycler.apoc4{background:
  radial-gradient(60% 90% at 60% 8%, rgba(180,180,200,.10), transparent),
  linear-gradient(#0f1012,#09090a);}
.bgCycler.apoc5{background:
  radial-gradient(55% 85% at 50% 5%, rgba(255,220,0,.10), transparent),
  linear-gradient(#151316,#0b0b0c);}

.arena{position:absolute; inset:0; z-index:1; overflow:hidden;
  background: radial-gradient(65% 90% at 50% 100%,rgba(0,0,0,.55),transparent 70%);
}
.fx{position:absolute; inset:0; z-index:2; pointer-events:none}
.hud{position:absolute; left:12px; bottom:12px; z-index:3; display:flex; gap:8px; flex-wrap:wrap}
button{
  background:linear-gradient(180deg, #2a2a2e, #202024);
  color:#f2f2f2; border:1px solid #34343a; border-radius:10px;
  padding:8px 12px; cursor:pointer; font-weight:700; letter-spacing:.3px;
  box-shadow: 0 1px 0 #000, inset 0 0 12px #0b0b0c;
}
button:hover{filter:brightness(1.07)}
button.danger{background:linear-gradient(180deg, #5b020a, #3a0107); border-color:#4a0108}

.fighter{
  position:absolute; width:92px; height:124px; transform:translate(-50%,-50%);
  display:flex; flex-direction:column; align-items:center; gap:6px; will-change:transform, filter, opacity;
}
.sprite{
  width:92px; height:92px; border-radius:10px; overflow:hidden; background:#0c0c0e;
  border:1px solid #26262a; box-shadow: 0 6px 20px rgba(0,0,0,.6);
  position:relative;
}
.sprite img{width:100%; height:100%; object-fit:cover; filter:contrast(1.05) saturate(1.05)}
.name{font-weight:800; font-size:.9rem; text-shadow:0 2px 6px #000}
.tag{font-size:.7rem; opacity:.75}
.alive .sprite{animation:idle 2.2s ease-in-out infinite}
@keyframes idle{0%{transform:translateY(0)}50%{transform:translateY(-3px)}100%{transform:translateY(0)}}
.dead .sprite{filter:grayscale(100%) contrast(.75) brightness(.65); opacity:.4}
.dead .name{opacity:.5}

.hitFlash{animation:hit .22s ease}
@keyframes hit{from{filter:brightness(2)} to{filter:brightness(1)}}
.fall{animation:fall .6s ease forwards}
@keyframes fall{to{transform:translate(-50%,-20%) rotate(12deg); opacity:.1}}

.splatterOverlay{
  position:absolute; inset:0; z-index:4; pointer-events:none; opacity:.85; display:none;
  background:
    radial-gradient(ellipse at 30% 20%, rgba(163,3,18,.95), transparent 55%),
    radial-gradient(ellipse at 70% 60%, rgba(163,3,18,.85), transparent 60%),
    radial-gradient(ellipse at 10% 90%, rgba(163,3,18,.7), transparent 50%),
    radial-gradient(circle at 85% 15%, rgba(163,3,18,.6), transparent 40%);
  mix-blend-mode:multiply;
}
.splatterOverlay.show{display:block; animation:splatter .6s cubic-bezier(.2,.9,.1,1) forwards}
@keyframes splatter{0%{transform:scale(.2) rotate(-10deg)}70%{transform:scale(1.15) rotate(8deg)}100%{transform:scale(1) rotate(0)}}

.log{
  flex:1; overflow:auto; padding:10px; background:#121214; border-radius:10px; border:1px solid #202024;
}
.entry{margin:8px 0; line-height:1.25rem; animation:pop .25s ease}
.entry b{color:#fff}
.kill{color:var(--gore)}
@keyframes pop{from{transform:scale(.98); opacity:0} to{transform:scale(1); opacity:1}}

.final{margin-top:12px; padding:10px; background:#121214; border:1px solid #202024; border-radius:10px}
.rankList{list-style:none; padding:0; margin:0}
.rankItem{
  display:flex; align-items:center; gap:10px; padding:8px 10px; margin:6px 0;
  background:linear-gradient(90deg, rgba(163,3,18,.18), transparent 60%);
  border-left:4px solid var(--gore); border-radius:8px; opacity:0; transform:translateX(-8px);
}
.rankItem.reveal{animation:slideIn .45s ease forwards}
@keyframes slideIn{to{opacity:1; transform:none}}
.rankNum{font-weight:900; min-width:42px}
.mini{
  width:44px; height:44px; object-fit:cover; border-radius:6px; border:1px solid #2a2a2e;
  filter:grayscale(100%) contrast(.8);
}
.winnerRow{
  background:linear-gradient(90deg, rgba(255,204,0,.15), rgba(163,3,18,.15));
  border-left-color:var(--accent);
}
.crown{
  width:34px; height:34px; display:inline-block; position:relative;
  filter:drop-shadow(0 0 10px #000);
  background:
    radial-gradient(circle at 50% 70%, var(--gore) 0 30%, transparent 35% 100%),
    conic-gradient(from 0deg, var(--accent) 0 100%);
  -webkit-mask:
    radial-gradient(circle 8px at 15% 35%, #000 98%, transparent) no-repeat,
    radial-gradient(circle 8px at 50% 10%, #000 98%, transparent) no-repeat,
    radial-gradient(circle 8px at 85% 35%, #000 98%, transparent) no-repeat,
    linear-gradient(#000 0 0) no-repeat;
  -webkit-mask-size: 16px 16px,16px 16px,16px 16px, 100% 70%;
  -webkit-mask-position: 8% 8%, calc(50% - 8px) 0%, 76% 8%, 0 30%;
  transform-origin:50% -60px; transform:translateY(-8px) scale(.98);
}
.slam{animation:crownSlam .55s cubic-bezier(.25,1.25,.2,1) forwards}
@keyframes crownSlam{
  0%{transform: translateY(-140px) scale(1.3) rotate(-8deg)}
  70%{transform: translateY(6px) scale(.96)}
  100%{transform: translateY(0) scale(1)}
}

.foot{padding:8px 12px; text-align:center; opacity:.7; font-size:.85rem}
</style>
</head>
<body>
  <header class="topbar">
    <h1>Battle Royale of Shame</h1>
    <p class="sub">Cinematic fight sim • dark • gory • random • 1st = winner, 10th = first out</p>
  </header>

  <main class="wrap">
    <section class="panel arenaPanel">
      <div class="bgCycler" id="bgCycler"></div>
      <canvas id="fx" class="fx"></canvas>
      <div id="arena" class="arena" aria-label="combat arena"></div>
      <div class="hud">
        <button id="speedBtn">Speed: Normal</button>
        <button id="pauseBtn">Pause</button>
        <button id="resetBtn" class="danger">Reset</button>
      </div>
      <div class="splatterOverlay" id="splatterOverlay"></div>
    </section>

    <section class="panel sidePanel">
      <h2>Kill Log</h2>
      <div id="log" class="log" aria-live="polite"></div>

      <div class="final" id="finalBoard" hidden>
        <h3>Final Rankings</h3>
        <ol id="rankList" class="rankList"></ol>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>Tip: later you can set portrait URLs in <code>PLAYERS</code> inside the script.</small>
  </footer>

<script>
// ===== Characters (plug portrait URLs later) =====
const PLAYERS = [
  { name: "Kidd", img: "", tag: "(F)" }, // sexy female warrior
  { name: "Neal", img: "" },
  { name: "Smith", img: "" },
  { name: "Wright", img: "" },
  { name: "Meeks", img: "" },
  { name: "Shrew", img: "" },
  { name: "Shinn", img: "" },
  { name: "Daughtry", img: "" },
  { name: "BB", img: "" },
  { name: "LB", img: "" },
];

const WEAPONS = [
  "rusted machete","jagged scrap spear","spiked bat",
  "sawed-off shotgun","broken axe head","Molotov",
  "heavy hook chain","crossbow","cracked warhammer","dual chipped knives"
];

const KILL_LINES = [
  (k,v,w)=>`${k} hacks ${v} apart with a ${w}, the dirt turns black with blood.`,
  (k,v,w)=>`${k} drives a ${w} through ${v}'s ribs — a wet crunch and silence.`,
  (k,v,w)=>`${k} sets ${v} ablaze with a ${w}; screams fade into smoke.`,
  (k,v,w)=>`${k} pulps ${v}'s skull with a ${w}. It does not stop shaking.`,
  (k,v,w)=>`${k} pins ${v} to wreckage with a ${w}; twitching stops slowly.`,
  (k,v,w)=>`${v} runs — ${k} doesn’t. One swing of the ${w}. Over.`,
  (k,v,w)=>`${k}'s ${w} meets bone; ${v} drops like discarded meat.`,
  (k,v,w)=>`${k} carves ${v} wide open with the ${w}; arena walls paint red.`
];

// ===== Arena + FX =====
const arena = document.getElementById("arena");
const logEl = document.getElementById("log");
const rankBoard = document.getElementById("finalBoard");
const rankList = document.getElementById("rankList");
const speedBtn = document.getElementById("speedBtn");
const pauseBtn = document.getElementById("pauseBtn");
const resetBtn = document.getElementById("resetBtn");
const fx = document.getElementById("fx");
const ctx = fx.getContext("2d");
const bg = document.getElementById("bgCycler");
const splatterOverlay = document.getElementById("splatterOverlay");

// size canvas to panel
function sizeCanvas(){
  fx.width = arena.clientWidth;
  fx.height = arena.clientHeight;
}
addEventListener("resize", sizeCanvas);

// animated blood particles (simple, fast)
const particles = [];
function spawnBlood(x,y,count=40){
  for(let i=0;i<count;i++){
    const a = Math.random()*Math.PI*2;
    const s = 1+Math.random()*3;
    particles.push({x,y,vx:Math.cos(a)*s, vy:Math.sin(a)*s, life: 400+Math.random()*500});
  }
}
function drawParticles(dt){
  ctx.clearRect(0,0,fx.width,fx.height);
  particles.forEach(p=>{
    p.x += p.vx; p.y += p.vy; p.vy += 0.02; // gravity
    p.life -= dt;
    ctx.globalAlpha = Math.max(0, Math.min(1, p.life/600));
    ctx.fillStyle = "#9b0312";
    ctx.beginPath(); ctx.arc(p.x,p.y, 1.6, 0, Math.PI*2); ctx.fill();
  });
  for(let i=particles.length-1;i>=0;i--) if(particles[i].life<=0) particles.splice(i,1);
  ctx.globalAlpha = 1;
}

// ===== Background cycling =====
const BG_CLASSES = ["apoc1","apoc2","apoc3","apoc4","apoc5"];
function cycleBackground(){
  const c = BG_CLASSES[Math.floor(Math.random()*BG_CLASSES.length)];
  bg.className = "bgCycler " + c;
}
setInterval(cycleBackground, 6000);
cycleBackground();

// ===== Game state =====
let fighters = [];
let eliminated = [];
let running = true;
let speedMode = "normal"; // "normal" | "fast"
const SPEED = { normal: [3200, 6200], fast: [1200, 2600] };
let lastTime = 0;

function rnd(min,max){ return Math.random()*(max-min)+min; }
function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }

function init(){
  sizeCanvas();
  running = true;
  logEl.innerHTML = "";
  rankBoard.hidden = true;
  rankList.innerHTML = "";
  eliminated = [];

  arena.innerHTML = "";
  fighters = PLAYERS.map(p=>({
    name: p.name, img: p.img, tag: p.tag||"",
    weapon: WEAPONS[Math.floor(Math.random()*WEAPONS.length)],
    x: rnd(80, arena.clientWidth-80),
    y: rnd(80, arena.clientHeight-80),
    vx: rnd(-0.6,0.6),
    vy: rnd(-0.6,0.6),
    alive: true,
    cool: 0, // fight cooldown
    node: null
  }));

  // DOM nodes for fighters
  fighters.forEach(f=>{
    const d = document.createElement("div");
    d.className = "fighter alive";
    d.style.left = f.x+"px"; d.style.top = f.y+"px";
    const placeholder = 'data:image/svg+xml;utf8,'+
      `<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160">`+
      `<rect width="100%" height="100%" fill="#0c0c0e"/>`+
      `<text x="50%" y="54%" dominant-baseline="middle" text-anchor="middle" fill="#bbb" font-family="Arial" font-size="20">IMG</text></svg>`;
    d.innerHTML = `
      <div class="sprite"><img alt="${f.name}" src="${f.img || placeholder}"/></div>
      <div class="name">${f.name} <span class="tag">${f.tag||""}</span></div>
    `;
    arena.appendChild(d);
    f.node = d;
  });

  lastTime = performance.now();
  requestAnimationFrame(tick);
}

// ===== Main loop: movement + collisions =====
function tick(t){
  const dt = Math.min(32, t-lastTime); lastTime = t;
  if(running){
    // move
    fighters.forEach(f=>{
      if(!f.alive) return;
      f.x += f.vx; f.y += f.vy;

      // bounce arena bounds
      if(f.x<50 || f.x>arena.clientWidth-50) f.vx*=-1;
      if(f.y<50 || f.y>arena.clientHeight-50) f.vy*=-1;

      // small random drift
      if(Math.random()<.01){ f.vx += rnd(-0.3,0.3); f.vy += rnd(-0.3,0.3); }
      f.vx = clamp(f.vx,-1,1);
      f.vy = clamp(f.vy,-1,1);

      f.node.style.left = f.x+"px";
      f.node.style.top  = f.y+"px";
      if(f.cool>0) f.cool -= dt;
    });

    // collisions -> chance to fight
    for(let i=0;i<fighters.length;i++){
      for(let j=i+1;j<fighters.length;j++){
        const a = fighters[i], b = fighters[j];
        if(!a.alive || !b.alive) continue;
        const dx=a.x-b.x, dy=a.y-b.y, d2=dx*dx+dy*dy;
        if(d2 < 90*90 && a.cool<=0 && b.cool<=0){
          // encounter: roll for fight
          if(Math.random() < 0.6){
            doFight(a,b);
          }else{
            // shove apart lightly
            const mag = Math.sqrt(d2||1);
            const nx = dx/(mag||1), ny = dy/(mag||1);
            a.vx += nx*0.2; a.vy += ny*0.2;
            b.vx -= nx*0.2; b.vy -= ny*0.2;
            a.cool = b.cool = 500;
          }
        }
      }
    }
  }

  // FX layer
  drawParticles(dt);
  requestAnimationFrame(tick);
}

// ===== Fight + elimination (cinematic) =====
function doFight(a,b){
  const killer = Math.random()<0.5 ? a : b;
  const victim = killer===a ? b : a;

  // lunge animation
  lunge(killer, victim);

  // finish after delay (scaled by speed)
  const [min,max] = SPEED[speedMode];
  const finDelay = Math.max(400, Math.min(1200, (min+max)/6));
  setTimeout(()=>fatality(killer, victim), finDelay);

  a.cool = b.cool = 1200;
}

function lunge(k,v){
  const nx = v.x - k.x, ny = v.y - k.y;
  const ang = Math.atan2(ny,nx);
  const dist = Math.min(40, Math.hypot(nx,ny)-50);
  const dx = Math.cos(ang)*dist, dy=Math.sin(ang)*dist;

  k.node.querySelector(".sprite").classList.add("hitFlash");
  v.node.querySelector(".sprite").classList.add("hitFlash");
  k.x += dx; k.y += dy; v.x -= dx*0.1; v.y -= dy*0.1;
}

function cameraShake(ms=250, mag=6){
  const el = arena;
  const start = performance.now();
  function step(t){
    const e = t - start;
    if(e>ms){ el.style.transform = ""; return; }
    const x = (Math.random()*2-1)*mag, y = (Math.random()*2-1)*mag;
    el.style.transform = `translate(${x}px,${y}px)`;
    requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function fatality(killer, victim){
  if(!killer.alive || !victim.alive) return; // double-check

  // gore peedBtn.addEventListener("click", ()=>{
